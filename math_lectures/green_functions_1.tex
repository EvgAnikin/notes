\documentclass{article}
\usepackage{amsmath}
\usepackage{bbm}
\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[T1, T2A]{fontenc}
\usepackage[english,russian]{babel}

\newcommand{\bra}{\langle}
\newcommand{\ket}{\rangle}
\newcommand{\p}{\partial}

\newtheorem{problem}{Задача}

\title{Функции Грина --- продолжение}
\author{Anikin Evgeny}

\begin{document}
\maketitle
\section{Примеры использования функций Грина в физике}
\subsection{Запаздывающие потенциалы}
Общая задача электродинамики --- найти электромагнитные поля при заданном
движении зарядов, то есть решить уравнения Максвелла. Последние записываются в виде
\begin{equation}
    \partial_\mu F^{\mu \nu} = 4\pi j^{\nu},
\end{equation}
где $\mu, \nu = 0\dots3$, $j^\nu$ --- вектор четырёхмерной плотности тока 
($j^0$ --- плотность заряда, а $j^{k}$ --- трёхмерная плотность тока), а 
$F_{\mu\nu} = \partial_\mu A_\nu - \partial_\nu A_\mu$ --- тензор электроманнитного поля. 
$A_\mu$ --- четырёхмерный вектор--потенциал. 

Уравнения Максвелла калибровочно инвариантны. Это значит, что если $A_\mu$ --- решение
уравнений, то 
\begin{equation}
    \label{gauge_transform}
   A'_\mu = A_\mu + \partial_\mu \chi
\end{equation}
тоже является решением ($\chi$ --- произвольная функция координат и времени). Преобразование
\eqref{gauge_transform} называется \emph{калибровочным}.

Калибровочные преобразования позволяют наложить некоторое дополнительное условие на $A_\mu$.
Удобно потребовать, чтобы выполнялось так называемое условие Лоренца:
\begin{equation}
    \label{lorentz_condition}
    \partial_\mu A^\mu = 0
\end{equation}
С его помощью можно преобразовать уравнения Максвелла:
\begin{equation}
    \partial_\mu (\partial^\mu A^\nu - \partial^\nu A^\mu) = 
        \partial_\mu \partial^\mu A^\nu = 4\pi j^\nu
\end{equation}
Таким образом, мы получаем волновое уравнение для каждой компоненты вектор--потенциала.
Его можно решить, использовав функцию Грина волнового уравнения.
\begin{equation}
    G(x,t) = \frac{1}{2\pi} \delta(t^2 - |x|^2) =
        \frac{1}{4\pi r} \delta(t - |x|)\theta(t)
\end{equation}
Решение с помощью функции Грина записывается в виде
\begin{multline}
    A^\nu(t,x) = \int dt' d^3x'  4\pi j^\nu(t',x') G(t-t',x-x') = \\
        =\int d^3 x' 4\pi j^\nu(t',x') 
            \frac{1}{4\pi |x - x'|} \delta(t-t'-|x-x'|)\theta(t) = \\
            =\int d^3 x' \frac{j^{\nu}(t - |x - x'|, x')}{|x - x'|}
\end{multline}
Таким образом, 
\begin{equation}
   A^\nu(t,x)=\int d^3 x' \frac{j^{\nu}(t - |x - x'|, x')}{|x - x'|}
\end{equation}
Это --- формула для запаздывающих потенциалов из Ландау--Лифшица.

\begin{problem}
    Найти функцию Грина уравнения Гельмгольца:
    \begin{equation}
        (\omega_0^2 + \nabla^2)\phi = -\delta(\vec{r})
    \end{equation}
    Знак минус стоит для согласованности с волновым уравнением и уравнением Пуассона. 
\end{problem}

\subsection{Интегральное уравнение Шрёдингера и волновые функции дельта--ям}
Рассмотрим одномерное уравнение Шрёдингера для частицы в потенциальной яме:
\begin{equation}
    \left[-\frac{\hbar^2}{2m} \frac{\partial^2}{\partial x^2} + U(x)\right] \Psi(x) = E\Psi(x)
\end{equation}
Перепишем его в виде
\begin{equation}
    \label{schrodinger_mod}
    \Psi(x)'' + \frac{2mE}{\hbar^2}\Psi(x) = \frac{2mU(x)}{\hbar^2} \Psi(x)
\end{equation}
Будем решать задачу о связанном состоянии в дельта--яме. В этом случае $E < 0$. 

Нетрудно показать, что функция Грина оператора, стоящего в левой части, равна
\begin{equation}
    G(x) = \frac{1}{2\kappa} e^{-\kappa |x|}, \quad \kappa \equiv \frac{2m|E}{\hbar^2}
\end{equation}

Теперь посмотрим внимательно на уравнение Шрёдингера \eqref{schrodinger_mod}. Если бы
в правой части была известная функция, $\Psi$ выражалась бы обычным образом через 
функцию Грина. Однако в правой части тоже стоит $\Psi$. Тем не менее, выражение через 
функцию Грина тоже можно записать:
\begin{equation}
    \label{schrodinger_int}
    \Psi(x) = \int dx' \frac{2mU(x')}{\hbar^2} \Psi(x') G(x - x') + \text{однородное решение}
\end{equation}
Это, конечно, не ответ, а интегральное уравнение. Однако оно элементарно решается, если
$U(x) = U_0 \delta(x)$. 

Во--первых, однородные решения для $E < 0$ --- это растущие экспоненты. Так как в квантовой
механике нас интересуют решения, во всяком случае не растущие на бесконечности, однородного
слагаемого в \eqref{schrodinger_int} не будет. 

Подставим $U(x) = U_0 \delta(x)$ в \eqref{schrodinger_int}. Интеграл с дельта--функцией 
берётся, и в результате получается выражение
\begin{equation}
   \Psi(x) = \frac{2mU_0}{\hbar^2} \Psi(0) \frac{1}{2\kappa} e^{-\kappa |x|}
\end{equation}
Оно выглядит немного странно: функция $\Psi(x)$ выражается через своё значение в нуле. 
Чтобы такое выражение имело смысл, оно должно быть самосогласованным, то есть
\begin{equation}
   \Psi(0) = \frac{mU_0}{\kappa\hbar^2} \Psi(0) 
\end{equation}
Отсюда следует, что $\kappa = \frac{mU_0}{\hbar^2}$, и 
\begin{equation}
    E = -\frac{mU_0^2}{2\hbar^2}
\end{equation}

\begin{problem}
Рассмотреть одномерное уравнение Шрёдингера с потенциалом 
$U(x) = U_0(\delta(x - a) + \delta(x + a))$. Найти в нём связанные состояния аналогичным 
способом. 
\end{problem}

Именно при решении этой задачи становится очевидным преимущество метода функций Грина. Задачу
с одной дельта--ямой очень просто решить, просто сшивая экспоненты слева и справа от 
ямы. В случае с двумя ямами это тоже можно сделать, однако вычисления становятся более
громоздкими, тогда как с помощью функций Грина ответ, можно сказать, записывается сразу.

\section{Функция Грина как обратный оператор}
Любая функция $g(x,y)$ 
двух переменных задаёт линейный оператор $\hat{L}_g$, действующий 
на пространстве функций следующим образом:
\begin{equation}
    \hat{L}_g\phi(x) = \int  g(x,y) \phi(y) dy
\end{equation}
Несложно заметить здесь сходство с правилами перемножения матриц.

Функция $g(x,y)$ может быть (и часто является) не обычной, а обобщённой функцией. Например,
единичный оператор задаётся дельта--функцией:
\begin{equation}
    \int \delta(x-y) \phi(y) dy = \phi(x)
\end{equation}
Дифференциальные операторы задаются производными от дельта--функции. Например,
\begin{equation}
    \frac{d}{dx} \phi(x) = \int \delta'(x-y) \phi(y) dy
\end{equation}

Вооружившись этим знанием, нетрудно заметить, что уравнение на функцию Грина
\begin{equation}
    \hat{L}G(x,y) = \delta(x-y)
\end{equation}
есть в точности уравнение на оператор, обратный $\hat{L}$. В операторном виде
\begin{equation}
    \hat{L} \hat{G} = \mathbbm{1},
\end{equation}
или даже 
\begin{equation}
    \hat{G} = \hat{L}^{-1}
\end{equation}
У оператора $\hat{L}$ могут быть нулевые собственные 
значения. В этом случае обратного оператора, действующего на том же самом пространстве,
не существует. (Интересный вопрос заключается в том, как это соотносится с предыдущим листком,
где у операторов, определённых на прямой, точно есть нулевые собственные значения).

%\section{Некоторые замечания}
%В предыдущем листке подразумевалось, что речь идёт о задаче эволюции во времени. 
%Возможна также ситуация, когда в задаче поставлены граничные условия. А именно, будем решать
%уравнение 
%\begin{equation}
%    \hat{L}\phi = f(x),
%\end{equation}
%где $x$ --- координата в $n$--мерном пространстве, функция $f$ задана в области
%$M$, и есть какие--нибудь граничные условия на $\partial M$ 
%(например, $\phi(x) = 0$ при $x \in \partial M$). 

\subsection{Функция Грина гармонического осциллятора с периодическими граничными условиями}
Будем решать уравнение
\begin{equation}
    \ddot{x} + \omega_0^2 x = \delta(t - t_0),
\end{equation}
гдe $x = x(t)$, $t\in [-\pi, \pi]$, и наложены периодические граничные условия:
$x(-\pi) = x(\pi)$, $\dot{x}(-\pi) = \dot{x}(\pi)$. 
Можно действовать двумя способами:
можно искать функцию Грина в виде ряда Фурье, а можно сшивать решения справа и слева от
дельта--функции. Ниже мы будем сшивать решения.

Так как оператор $\partial_t^2 + \omega^2$ не зависит от времени, 
функция Грина зависит только от $t - t_0$. Поэтому можно положить $t_0 = 0$. (Это ---
специфическая особенность периодических граничных условий! Для любых других граничных условий
функция Грина не представляется в виде $G(t - t_0)$.)

Будем искать решение в виде
\begin{equation}
    G(t) = \left\{\begin{matrix}
                A\cos{\omega_0 t} + B\sin{\omega_0 t} & \text{при} \quad t > 0\\
                C\cos{\omega_0 t} + D\sin{\omega_0 t} & \text{при} \quad t < 0\\
           \end{matrix}\right.
\end{equation}
Условие непрерывности в $t = 0$ приводит к 
\begin{equation}
    A = C
\end{equation}
условие сшивки ---
\begin{equation}
    \omega_0(B - D) = 1.
\end{equation}
Периодические граничные условия принимают вид 
\begin{equation}
    \begin{gathered}
        B + D = 0\\
        -A\omega_0 \sin{\pi\omega_0} + B\omega_0 \cos{\pi \omega_0} = 
            C \omega_0 \sin{\pi \omega_0} + D\omega_0 \cos{\pi \omega_0}
    \end{gathered}
\end{equation}
Отсюда получаем
\begin{equation}
    \begin{gathered}
        A = \frac{\cos{\pi\omega_0}}{2\omega_0 \sin{\pi \omega_0}}\\
        B = \frac{1}{2\omega_0}
    \end{gathered}
\end{equation}
Значит,
\begin{equation}
    G(t - t_0) = \frac{\cos{\omega_0 (t - t_0 \mp \pi)}}
                {2\omega_0 \sin{\pi \omega_0}},
\end{equation}
где минус берётся при $t > 0$, а плюс ---  при $t < 0$.

При целых $\omega$ функции Грина не существует: синус в знаменателе обращается в ноль.
Действительно, в этом случае существуют собственные векторы,
отвечающие нулевому собственному значению 
оператора $\partial_t^2 + \omega^2$, а именно ---  $\cos{\omega_0 t}$, $\sin{\omega_0 t}$.
\end{document}
